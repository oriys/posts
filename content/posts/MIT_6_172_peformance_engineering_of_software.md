---
title: "MIT 6.172 笔记"
date: 2021-03-03T23:33:18+08:00
draft: true
---

## 课程介绍和矩阵乘法

- 为什么需要软件性能工程
  - 性能是计算的货币，你可以用性能交换需要的属性
  - 硬件资源是有限的
  - 软件没有经过性能工程无法满足要求
- 为什么不要过早优化
  - 代码会变得不可读
- 摩尔定律
  - 集成电路上可容纳的晶体管数目，约每隔两年便会增加一倍
- 2004 年后的技术升级
  - 单核 CPU 频率不再随着晶体管数量线性增长
  - 随着时钟频率的增长，单位面积功率每年以 25%-30%的速度增长
- 供应商的解决方法
  - 推出多核处理器
  - 各种架构的芯片出现，软件必须适应硬件才能有效提升性能
- 多核处理器推出后，相关的 bug 和岗位需求都明显增长
- 多核编程依然很难
- 案例学习:python 实现的 4096\*4096 矩阵乘法
  - Java 重新实现，绝对性能提升 9 倍
    - 解释字节码
    - JIT 优化，编译成机器码执行
  - C 重新实现，绝对性能提升 18 倍
    - 机器码执行
  - 交换循环的顺序, 性能提升 118 倍
    - 提高缓存命中率
  - 编译器开启编译优化，性能提升 385 倍
    - 循环展开等优化
  - 使用`cilk_for`并行循环，性能提升 6921 倍
    - 多核并行计算，充分利用处理器资源
  - 将矩阵切分成多个块计算，性能提升 11772 倍
    - 进一步提高 cache 命中率
  - 并行分治，性能提升 16197 倍
    - 调节切块尺寸，利用二级和三级缓存
  - 编译期向量支持，性能提升 30272 倍
    - 编译期使用`SIDM`指令
  - 手写 AVX 指令的代码，性能提升 53272 倍
    - 不依赖编译期，自己利用 AVX 指令实现算法
  - intel MKL 数学计算库，性能提升 51497 倍
    - 虽然没有胜过上一步，但是在通用矩阵计算场景下更优
  - 更多优化手段
    - 预处理
    - 矩阵转置
    - 数据对齐
    - 内存管理优化
    - 更好的显式利用 AVX 指令的算法
- 性能工程的好处
  - 减少能源消耗
